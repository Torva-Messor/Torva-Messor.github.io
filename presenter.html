<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Torva Presenter</title>
    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.7.6.3.min.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background: #111; color: #fff; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; }
        h1 { color: #00f2ff; font-size: 1.5rem; margin-bottom: 30px; text-align: center; }
        .button-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; max-width: 400px; }
        button { background: #222; border: 1px solid #444; color: white; padding: 20px; border-radius: 10px; font-size: 1rem; cursor: pointer; transition: all 0.2s; }
        button:active { transform: scale(0.95); background: #333; }
        
        .btn-action { border-color: #00f2ff; color: #00f2ff; }
        .btn-video { border-color: #fff; background: #333; } /* Video Button etwas hervorgehoben */
        .btn-damage { border-color: #ff0055; color: #ff0055; }
        .btn-heal { border-color: #00ff88; color: #00ff88; }
        .full-width { grid-column: span 2; }
    </style>
</head>
<body>

    <h1 id="status">TORVA CONTROLLER</h1>

    <div class="button-grid">
        <button class="btn-action" onclick="sendCommand(0, 'morph_go')">‚¨ÖÔ∏è GO Brett (Reset)</button>
        <button class="btn-action" onclick="sendCommand(0, 'morph_qr')">QR Code</button>
        
        <button class="btn-damage" onclick="sendCommand(null, 'damage')">Damage</button>
        <button class="btn-heal" onclick="sendCommand(null, 'heal')">Heal</button>
        
        <button class="btn-video full-width" onclick="sendCommand(2, 'play_video')">üé• Play Video</button>
        <button class="btn-video full-width" onclick="sendCommand(3, null)">ü§ñ AR Object</button>
    </div>

    <script>
        // DEINE KEYS
        const publishKey = 'pub-c-f5b11d3c-ddfe-4dfc-963e-6fae738aeb03'; 
        const subscribeKey = 'sub-c-6fdfc9e3-91b8-4f79-b62a-6fd9fc69eff7';
        const channelName = 'PrasiW.Woche';

        const pubnub = new PubNub({
            publishKey: publishKey,
            subscribeKey: subscribeKey,
            userId: "presenter_mobile"
        });

        function sendCommand(slideIndex, actionName) {
            const payload = {};
            // Wenn slide 0 ist, sende 0. Wenn null, sende nichts.
            if (slideIndex !== null) payload.slide = slideIndex;
            if (actionName !== null) payload.action = actionName;
            
            const statusEl = document.getElementById('status');
            statusEl.innerText = "Sende...";

            pubnub.publish({
                channel: channelName,
                message: payload
            }, (status) => {
                if (status.error) {
                    statusEl.innerText = "FEHLER!";
                    console.error(status);
                } else {
                    statusEl.innerText = "OK";
                    setTimeout(() => { statusEl.innerText = "TORVA CONTROLLER"; }, 500);
                }
            });
        }
    </script>
</body>
</html>
