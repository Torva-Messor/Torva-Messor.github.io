<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Go to QR Morph</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/black.min.css">

    <style>
        /* --- STEVE JOBS AESTHETIC --- */
        :root { --accent: #00f2ff; --bg: #050505; --stone-white: #f0f0f0; --stone-black: #1a1a1a; }
        body { background: var(--bg); font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }

        /* Das Grid */
        .morph-container {
            display: grid;
            grid-template-columns: repeat(15, 1fr); /* 15x15 Grid für bessere QR Optik */
            grid-template-rows: repeat(15, 1fr);
            gap: 6px;
            width: 55vmin;
            height: 55vmin;
            margin: 0 auto;
            position: relative;
            transition: transform 1s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .dot {
            width: 100%;
            height: 100%;
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1); /* Bouncy effekt */
        }

        /* --- ZUSTAND 1: GO BRETT (Organisch, Rund, 3D) --- */
        .mode-go .dot {
            border-radius: 50%;
            transform: scale(0.85);
            box-shadow: inset -2px -2px 6px rgba(0,0,0,0.5); /* 3D Effekt */
        }
        .mode-go .dot.state-0 { background: transparent; box-shadow: none; } /* Leeres Feld */
        .mode-go .dot.state-1 { background: radial-gradient(circle at 30% 30%, #555, #000); } /* Schwarzer Stein */
        .mode-go .dot.state-2 { background: radial-gradient(circle at 30% 30%, #fff, #ccc); box-shadow: 0 2px 5px rgba(0,0,0,0.5); } /* Weißer Stein */

        /* --- ZUSTAND 2: QR CODE (Digital, Eckig, Leuchtend) --- */
        .mode-qr { transform: rotate(0deg) scale(1.1); }
        
        .mode-qr .dot {
            border-radius: 2px; /* Fast eckig, ganz leicht weich für Modernität */
            transform: scale(1.0);
            box-shadow: none;
        }
        
        /* Im QR Modus ignorieren wir schwarz/weiß und machen alles zur "Datenfarbe" oder transparent */
        .mode-qr .dot.qr-active {
            background: var(--accent);
            box-shadow: 0 0 15px var(--accent); /* Neon Glow */
        }
        .mode-qr .dot.qr-inactive {
            background: rgba(255,255,255,0.05); /* Leichte Grid Spur */
            transform: scale(0.3);
        }

        /* --- TYPOGRAPHY & LAYOUT --- */
        .reveal h1 { 
            font-weight: 800; letter-spacing: -0.05em; 
            background: linear-gradient(180deg, #fff, #888); 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .caption {
            font-size: 1.5rem; color: #666; margin-top: 40px; font-weight: 300; letter-spacing: 0.2em; text-transform: uppercase;
            transition: opacity 0.5s;
        }

        /* Helper für den Button */
        #start-overlay { position: fixed; inset: 0; background: #000; z-index: 999; display: flex; align-items: center; justify-content: center; }
        button { background: transparent; color: var(--accent); border: 1px solid var(--accent); padding: 15px 40px; font-size: 1.2rem; cursor: pointer; border-radius: 50px; }
    </style>
</head>
<body>

    <div id="start-overlay"><button onclick="initApp()">INITIALIZE SYSTEM</button></div>

    <div class="reveal">
        <div class="slides">

            <section>
                <h1>THE LINK</h1>
                <p style="color: #666">Von analoger Strategie zu digitaler Identität.</p>
            </section>

            <section id="morph-slide" data-auto-animate>
                <div id="grid-container" class="morph-container mode-go">
                    </div>
                <div id="text-caption" class="caption">The Game of Go (1992)</div>
            </section>

            <section>
                <h2>AR READY</h2>
            </section>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.7.6.3.min.js"></script>
    <script src="config.js"></script> <script>
        const deck = new Reveal();
        deck.initialize({ controls: false, progress: false, center: true, transition: 'fade' });

        const grid = document.getElementById('grid-container');
        const caption = document.getElementById('text-caption');
        const gridSize = 15; // 15x15 Grid
        let dots = [];

        function createGrid() {
            grid.innerHTML = '';
            dots = [];
            for (let i = 0; i < gridSize * gridSize; i++) {
                let d = document.createElement('div');
                d.className = 'dot state-0 qr-inactive'; // Default state
                
                // Wir fügen jedem Stein ein zufälliges Delay hinzu für den "Wellen-Effekt"
                d.style.transitionDelay = (Math.random() * 0.3) + 's';
                
                grid.appendChild(d);
                dots.push(d);
            }
            renderGo(); // Start mit Go
        }

        // Simuliert Go-Brett Muster
        function renderGo() {
            grid.className = 'morph-container mode-go';
            caption.innerHTML = "The Inspiration: Go";
            
            dots.forEach(d => {
                // Reset Klassen
                d.classList.remove('qr-active', 'qr-inactive');
                
                // Zufällige Go Verteilung (Mehr leere Felder)
                let r = Math.random();
                d.classList.remove('state-0', 'state-1', 'state-2');
                if(r > 0.85) d.classList.add('state-1'); // Schwarz
                else if(r > 0.7) d.classList.add('state-2'); // Weiß
                else d.classList.add('state-0'); // Leer
            });
        }

        // Simuliert QR Code (mit Finder Patterns in den Ecken)
        function renderQR() {
            grid.className = 'morph-container mode-qr';
            caption.innerHTML = '<span style="color:var(--accent)">The Result: QR Code</span>';

            dots.forEach((d, i) => {
                const x = i % gridSize;
                const y = Math.floor(i / gridSize);

                // Logik für "Finder Patterns" (Die großen Quadrate in den Ecken)
                // Oben Links, Oben Rechts, Unten Links
                const isFinder = (x < 4 && y < 4) || (x > gridSize - 5 && y < 4) || (x < 4 && y > gridSize - 5);
                
                let isActive = false;
                
                if (isFinder) {
                    // Mache Ringe für Finder Patterns
                    // Außenring voll, Mitte leer, Punkt in Mitte
                    isActive = true; 
                    // Simpler Hack für hohle Quadrate:
                    if((x===1||x===gridSize-2||x===gridSize-3) && (y>=1 && y<=2)) isActive = false; // Kleine Anpassung für Optik
                } else {
                    // Rest ist zufälliges Rauschen (Daten)
                    isActive = Math.random() > 0.5;
                }

                if(isActive) {
                    d.classList.add('qr-active');
                    d.classList.remove('qr-inactive');
                } else {
                    d.classList.add('qr-inactive');
                    d.classList.remove('qr-active');
                }
            });
        }

        function initApp() {
            document.getElementById('start-overlay').style.display = 'none';
            createGrid();

            // Setup PubNub
            const pubnub = new PubNub({ subscribeKey: Pub_Nub_api_Subscribe, userId: "viewer" });
            pubnub.addListener({
                message: (m) => {
                    const msg = m.message;
                    if(msg.slide !== undefined) deck.slide(msg.slide);
                    
                    // DER MAGIC TRIGGER
                    if(msg.action === "morph") {
                        if(msg.state === "qr") renderQR();
                        else renderGo();
                    }
                }
            });
            pubnub.subscribe({ channels: [My_Channel_Name] });
        }
    </script>
</body>
</html>
